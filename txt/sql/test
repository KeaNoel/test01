2019-07-19 08:13:16
2019-07-19 08:15:51

SELECT F.*,ARDS.ARDS04 FROM
(SELECT E.*,ards01,ards02 FROM(
SELECT D.*,ars01,ars02 FROM(
SELECT C.*,armo03,armo02 FROM(
SELECT B.*,ARWOSD02 FROM(
SELECT A.*,ARWP05,ARWP06 FROM (
SELECT ARMO01,ARWO01,ARWOSD01,ARWOSD04,STRING_AGG(CAST(ARPC05 AS VARCHAR), ','),SUM(ARWIPF02),ARWP04,ARWP02,ARWP01,ARWIPF06,ARWIPF08 FROM(
SELECT ARMO01,ARPC.ARWO01,ARPC.ARWOSD01,ARPC.ARWOSD04,ARPC.ARPC05,ARWIPF.ARPC01,ARWIPF02,ARWP04,ARWP02,ARWP01,ARWIPF06,ARWIPF08 FROM(
SELECT ARPC01,SUM(ARWIPF02) as ARWIPF02,ARWP04,ARWP02,ARWP01,ARWIPF06,DATE(ARWIPF08)ARWIPF08 FROM ARWIPF WHERE ARWIPF08 BETWEEN '2019-07-19 08:13:16'AND '2019-07-19 08:15:51'GROUP BY ARPC01,ARWIPF02,ARWP04,ARWP02,ARWP01,ARWIPF06,ARWIPF08) ARWIPF
INNER JOIN ARPC ON ARWIPF.ARPC01 = ARPC.ARPC01 ORDER BY ARMO01,ARWOSD01,ARWOSD04,ARPC05
)ARWIPF_ARPC GROUP BY ARMO01,ARWO01,ARWOSD01,ARWOSD04,ARWIPF02,ARWP04,ARWP02,ARWP01,ARWIPF06,ARWIPF08)A
INNER JOIN (
SELECT ARWP.* FROM ARWP LEFT JOIN(
SELECT ARWO01,MAX(ARWP03)ARWP03 FROM ARWP GROUP BY ARWO01)ARWP_ARWP03
ON
ARWP.ARWO01 = ARWP_ARWP03.ARWO01 AND
ARWP.ARWP03 = ARWP_ARWP03.ARWP03
WHERE ARWP_ARWP03.ARWO01 IS NOT NULL)ARWP ON A.ARWO01 = ARWP.ARWO01 AND A.ARWOSD01 = ARWP.ARWOSD01 AND A.ARWP04 = ARWP.ARWP04 AND A.ARWP01 = ARWP.ARWP01)B
INNER JOIN (
SELECT ARWOSD.* FROM ARWOSD LEFT JOIN(
SELECT ARWO01,MAX(ARWOSD03)ARWOSD03 FROM ARWOSD GROUP BY ARWO01)ARWOSD_ARWOSD03
ON
ARWOSD.ARWO01 = ARWOSD_ARWOSD03.ARWO01 AND
ARWOSD.ARWOSD03 = ARWOSD_ARWOSD03.ARWOSD03
WHERE ARWOSD_ARWOSD03.ARWO01 IS NOT NULL)ARWOSD ON B.ARWO01 = ARWOSD.ARWO01 AND B.ARWOSD01 = B.ARWOSD01 AND B.ARWP04 = B.ARWP04 AND B.ARWP01 = B.ARWP01)C
INNER JOIN (
SELECT ARWO.* FROM ARWO LEFT JOIN(
SELECT ARWO01,MAX(ARWO02)ARWO02 FROM ARWO GROUP BY ARWO01)ARWO_ARWO02
ON
ARWO.ARWO01 = ARWO_ARWO02.ARWO01 AND
ARWO.ARWO02 = ARWO_ARWO02.ARWO02
WHERE ARWO_ARWO02.ARWO01 IS NOT NULL)ARWO ON C.ARWO01 = ARWO.ARWO01 AND C.ARWOSD01 = C.ARWOSD01 AND C.ARWP04 = C.ARWP04 AND C.ARWP01 = C.ARWP01)D
INNER JOIN ARS ON ARS.ars01 = D.ARWIPF06 AND D.ARWOSD01 = D.ARWOSD01 AND D.ARWP04 = D.ARWP04 AND D.ARWP01=D.ARWP01)E
INNER JOIN ARWI ON ARWI.ARWI01 =E .ARWP04 )F
INNER JOIN ARDS ON ARDS.ARDS01 = F. ARDS01 --WHERE 1=1 AND ards04='B4' AND F.ards01='F0124A500' AND ars01='5589' AND armo01='CYY19100062' AND arwo01='C488-1910140029' AND arwosd04='9T-10T'AND arwp01='30' AND
--armo02='PKFS20056PL UPPER SM'AND arwp05='A10'


SELECT * FROM ARDS LIMIT 2;












(
SELECT ARWO.* FROM ARWO LEFT JOIN(
SELECT ARWO01,MAX(ARWO02)ARWO02 FROM ARWO GROUP BY ARWO01)ARWO_ARWO02
ON
ARWO.ARWO01 = ARWO_ARWO02.ARWO01 AND
ARWO.ARWO02 = ARWO_ARWO02.ARWO02
WHERE ARWO_ARWO02.ARWO01 IS NOT NULL)ARWO;




SELECT * FROM(
SELECT ARWP.* FROM ARWP LEFT JOIN(
SELECT ARWO01,MAX(ARWP03)ARWP03 FROM ARWP GROUP BY ARWO01)ARWP_ARWP03
ON
ARWP.ARWO01 = ARWP_ARWP03.ARWO01 AND
ARWP.ARWP03 = ARWP_ARWP03.ARWP03
WHERE ARWP_ARWP03.ARWO01 IS NOT NULL)ARWP;





SELECT * FROM(
SELECT ARWOSD.* FROM ARWOSD LEFT JOIN(
SELECT ARWO01,MAX(ARWOSD03)ARWOSD03 FROM ARWOSD GROUP BY ARWO01)ARWOSD_ARWOSD03
ON
ARWOSD.ARWO01 = ARWOSD_ARWOSD03.ARWO01 AND
ARWOSD.ARWOSD03 = ARWOSD_ARWOSD03.ARWOSD03
WHERE ARWOSD_ARWOSD03.ARWO01 IS NOT NULL)ARWOSD;







SELECT F.*,ARDS.ARDS04 FROM
(SELECT E.*,ards01,ards02 FROM(
SELECT D.*,ars01,ars02 FROM(
SELECT C.*,armo03,armo02 FROM(
SELECT B.*,ARWOSD02 FROM(
SELECT A.*,ARWP05,ARWP06 FROM (
SELECT ARMO01,ARWO01,ARWOSD01,ARWOSD04,STRING_AGG(CAST(ARPC05 AS VARCHAR), ','),SUM(ARWIPF02),ARWP04,ARWP02,ARWP01,ARWIPF06,ARWIPF08 FROM(
SELECT ARMO01,ARPC.ARWO01,ARPC.ARWOSD01,ARPC.ARWOSD04,ARPC.ARPC05,ARWIPF.ARPC01,ARWIPF02,ARWP04,ARWP02,ARWP01,ARWIPF06,ARWIPF08 FROM(
SELECT ARPC01,SUM(ARWIPF02) as ARWIPF02,ARWP04,ARWP02,ARWP01,ARWIPF06,DATE(ARWIPF08)ARWIPF08 FROM ARWIPF WHERE ARWIPF08 BETWEEN '2019-07-19 08:13:16'AND '2019-07-19 08:15:51'GROUP BY ARPC01,ARWIPF02,ARWP04,ARWP02,ARWP01,ARWIPF06,ARWIPF08) ARWIPF
INNER JOIN ARPC ON ARWIPF.ARPC01 = ARPC.ARPC01 ORDER BY ARMO01,ARWOSD01,ARWOSD04,ARPC05
)ARWIPF_ARPC GROUP BY ARMO01,ARWO01,ARWOSD01,ARWOSD04,ARWIPF02,ARWP04,ARWP02,ARWP01,ARWIPF06,ARWIPF08)A
INNER JOIN ARWP ON A.ARWO01 = ARWP.ARWO01 AND A.ARWOSD01 = ARWP.ARWOSD01 AND A.ARWP04 = ARWP.ARWP04 AND A.ARWP01 = ARWP.ARWP01)B
INNER JOIN ARWOSD ON B.ARWO01 = ARWOSD.ARWO01 AND B.ARWOSD01 = B.ARWOSD01 AND B.ARWP04 = B.ARWP04 AND B.ARWP01 = B.ARWP01)C
INNER JOIN ARWO ON C.ARWO01 = ARWO.ARWO01 AND C.ARWOSD01 = C.ARWOSD01 AND C.ARWP04 = C.ARWP04 AND C.ARWP01 = C.ARWP01)D
INNER JOIN ARS ON ARS.ars01 = D.ARWIPF06 AND D.ARWOSD01 = D.ARWOSD01 AND D.ARWP04 = D.ARWP04 AND D.ARWP01=D.ARWP01)E
INNER JOIN ARWI ON ARWI.ARWI01 =E .ARWP04 )F
INNER JOIN ARDS ON ARDS.ARDS01 = F. ARDS01



